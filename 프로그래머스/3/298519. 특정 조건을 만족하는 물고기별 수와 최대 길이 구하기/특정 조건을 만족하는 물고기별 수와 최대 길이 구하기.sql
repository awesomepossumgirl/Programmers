SELECT COUNT(*) AS FISH_COUNT, MAX(LENGTH) AS MAX_LENGTH, FISH_TYPE
FROM fish_info
GROUP BY fish_type
HAVING AVG(IF(IFNULL(LENGTH,0) <= 10, 10, LENGTH)) >= 33
ORDER BY FISH_TYPE;